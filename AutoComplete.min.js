/**
* AutoComplte Class (Module) - jQuery plugin
* Require: jQuery,Class.js (https://github.com/abcrun/Class)
* The MIT License - Copyright (c) 2013 Hongbo Yang <abcrun@gmail.com>
* Repository - https://github.com/abcrun/sack.git
* Version - 0.2.3
*/
/*Class.js@https://github.com/abcrun/Class*/
!function(t,e){if(typeof define==="function"&&define.amd)define(e);else if(typeof module==="object"&&module.exports)module.exports=e();else this[t]=e()}("Class",function(){var t=function(t){return/\s(\w+)/.exec(Object.prototype.toString.call(t).toLowerCase())[1]};var e=function(t){for(key in t)this[key]=t[key];return this};var i=function(i,s){var n,r=t(i),u=t(s);i=r=="function"?[i]:r=="object"?(n=i)&&[i["constructor"]||function(){}]:[function(){}];if(n)delete n["constructor"];s=u=="function"?(i=i.concat(s.constructor||s))&&s.prototype:u=="object"?s:null;if(n&&!s){s=n;n=null}else{s=s||{}}if(!s.extended)s.extended=e;var o=function(){if(n)e.call(this,n)};o.prototype=s;var h=function(){var t=i.length;for(var e=t-1;e>=0;e--)i[e].apply(this,arguments)};h.constructor=i[0];h.prototype=new o;h.extended=function(s){s.extended=s.extended||e;i=[this.constructor];this.prototype=s;if(t(s)=="function"){i=i.concat(s.constructor||s);this.prototype=s.prototype}return this};h.implemented=function(t){this.prototype=(new o).extended(t)};return h};var s={};s.create=i;return s});var getPosition=function(t,e){var i=0;while(t){i+=t[e];t=t.offsetParent}return i};var AutoComplete=Class.create({constructor:function(t){var e;var i="oninput"in window?"input":"keyup";this.tip=t.tip||"Please input the keywords";this.input=t.input;if(!this.input)return;this.input.val(this.tip);this.form=t.form;if(!this.form&&(e=this.input.parents("form"))&&e.length){this.form=e;e=null}this.submit=t.submit||this.submit;this.getDatas=t.getDatas||this.getDatas;this.suggest=t.suggest;if(!this.suggest){var s=document.createElement("div"),n=getPosition(this.input[0],"offsetLeft"),r=getPosition(this.input[0],"offsetTop")+this.input.height();s.style.cssText="position:absolute;top:"+r+"px;left:"+n+"px";document.body.appendChild(s);this.suggest=jQuery(s)}this.suggest.hide();this.list=(t.list||"li").toLowerCase();this.hover=t.hover||"hover";this.input.focus(jQuery.proxy(this.focus,this));this.input.blur(jQuery.proxy(this.blur,this));this.input.keydown(jQuery.proxy(this.keydown,this));this.input.bind(i,jQuery.proxy(this.textInput,this));if(this.form)this.form.bind("submit",jQuery.proxy(this.submit,this));this.suggest.delegate(this.list,"mouseover",jQuery.proxy(this.mouseover,this));this.suggest.delegate(this.list,"click",jQuery.proxy(this.click,this))},focus:function(){if(this.input.val()==this.tip)this.input.val("")},blur:function(){var t=this;if(this.input.val()=="")this.input.val(this.tip);setTimeout(function(){t.suggest.hide();t.current=null},500)},setInputValue:function(t){var e,i=this.list;if(!this.current)this.current=this.suggest.find(i).first();e=this.current.attr("title")||this.current.text();this.input.val(e)},click:function(){this.setInputValue()},submit:function(t){if(this.form)t.preventDefault()},keydown:function(t){var e=t.keyCode,i=this.list,s=this.hover;if(e>=37&&e<=40){if(!this.suggest.find(i).length)return;t.preventDefault();if(this.current)this.current.removeClass(s);if(e==37||e==38){this.current=!this.current?this.suggest.find(i).last():this.current.prev().length?this.current.prev():this.suggest.find(i).last()}else{this.current=!this.current?this.suggest.find(i).first():this.current.next().length?this.current.next():this.suggest.find(i).first()}this.current.addClass(s);this.setInputValue()}else if(e==13){this.setInputValue();if(!this.form)this.submit()}},getDatas:function(){throw new Error('Method ".getDatas()" is needed.')},textInput:function(t){var e=t.keyCode;if(!e||(e>=48&&e<=90||e>=96&&e<=105||e==8||e==32||e==45)){this.getDatas()}},mouseover:function(t){var e=t.target;while(e&&e.nodeName.toLowerCase()!=this.list)e=e.parentNode;if(e.nodeName.toLowerCase()!=this.list)return;if(this.current)this.current.removeClass(this.hover);this.current=jQuery(e);this.current.addClass(this.hover)}});